<%- include('../partials/admin/header') %> 
<%- include('../partials/admin/sidebar') %>

<main class="col-span-1 p-4 sm:p-6 lg:col-span-4 lg:p-8">
  <header class="border-b-2 border-black pb-6 dark:border-gray-600">
    <div>
      <h1 class="text-4xl font-extrabold uppercase"><%= title %></h1>
      <p class="text-neutral-600 dark:text-neutral-400">
        YOUR API KEY AND ACCOUNT DETAILS
      </p>
    </div>
  </header>

  <section class="mt-8 space-y-8">
    <% if (error) { %>
      <p class="border-2 border-red-500 bg-red-100 p-3 text-center dark:bg-red-900 dark:text-red-200 dark:border-red-600">
        <%= error %>
      </p>
    <% } %>
    <% if (success) { %>
      <p class="border-2 border-green-500 bg-green-100 p-3 text-center dark:bg-green-900 dark:text-green-200 dark:border-green-600">
        <%= success %>
      </p>
    <% } %>

    <div class="border-2 border-black p-8 dark:border-gray-600">
      <h3
        class="mb-4 inline-block bg-black px-4 py-2 text-3xl font-bold uppercase text-yellow-300"
      >
        // Account Info
      </h3>
      <p class="text-lg"><strong>Username:</strong> <%= session.user.username %></p>
      <p class="text-lg"><strong>Role:</strong> <%= session.user.is_admin ? 'Administrator' : 'User' %></p>
      <p class="text-lg"><strong>Email:</strong> <%= userEmail %></p>
      
      <div class="mt-6 pt-4 border-t-2 border-black dark:border-gray-600">
        <a
          href="/admin/profile/edit"
          class="inline-block border-2 border-black bg-white px-4 py-2 font-bold uppercase text-black hover:bg-yellow-300 transition-colors dark:bg-gray-800 dark:text-gray-200 dark:border-gray-600 dark:hover:bg-yellow-300 dark:hover:text-black"
        >
          Edit Profile
        </a>
      </div>
    </div>

    <div class="border-2 border-black p-8 dark:border-gray-600">
      <h3
        class="mb-4 inline-block bg-black px-4 py-2 text-3xl font-bold uppercase text-yellow-300"
      >
        // Your API Key
      </h3>
      <p class="mb-4 text-neutral-600 dark:text-neutral-400">
        Use this key to post snippets programmatically. Treat it like a password
        and do not share it. If your key is compromised, you can generate a new one below.
      </p>
      <div class="flex gap-2">
        <input
          type="text"
          id="api-key-input"
          value="<%= apiKey %>"
          readonly
          class="w-full border-2 border-black bg-neutral-100 p-3 text-base focus:outline-none dark:bg-gray-800 dark:border-gray-600"
        />
        <button
          id="copy-api-key-btn"
          class="border-2 border-black bg-yellow-300 px-6 py-2 font-bold uppercase text-black"
        >
          Copy
        </button>
      </div>

      <div class="mt-6 pt-4 border-t-2 border-black dark:border-gray-600">
        <form
          id="regenerate-api-key-form"
          action="/admin/profile/regenerate-api-key"
          method="POST"
          class="inline-block"
        >
          <button
            id="open-regenerate-modal"
            type="submit"
            class="border-2 border-black bg-red-500 px-4 py-2 font-bold uppercase text-white hover:bg-red-600 transition-colors dark:bg-red-700 dark:hover:bg-red-800"
          >
            Regenerate API Key
          </button>
        </form>
      </div>
    </div>
  </section>
</main>

<%- include('../partials/admin/footer') %>

<%- include('../partials/admin/api-key-regenerate-modal') %>
